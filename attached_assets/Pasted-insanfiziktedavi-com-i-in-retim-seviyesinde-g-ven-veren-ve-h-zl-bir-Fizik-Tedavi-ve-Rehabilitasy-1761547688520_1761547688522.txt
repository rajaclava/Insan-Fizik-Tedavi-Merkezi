insanfiziktedavi.com iÃ§in Ã¼retim seviyesinde, gÃ¼ven veren ve hÄ±zlÄ± bir "Fizik Tedavi ve Rehabilitasyon" web uygulamasÄ± geliÅŸtir.

## TEKNOLOJÄ° YIÄINI
- Next.js 14 (App Router) + React 18 + TypeScript
- Tailwind CSS (temiz, kurumsal saÄŸlÄ±k temasÄ±)
- Prisma ORM + PostgreSQL
- Auth: NextAuth (Email/OTP + SMS/WhatsApp OTP opsiyonu) + JWT
- API: /api altÄ±nda REST benzeri route handlers (CRUD)
- Depolama: yerel /public + adaptÃ¶rle S3 uyumlu ( kolay switch )
- Ã–deme: PayTR (hazÄ±r server-side checkout entegrasyonu iÃ§in mock endpoint ve .env anahtarlarÄ±)
- Bildirim: E-posta (SMTP), WhatsApp deep link (wa.me), SMS (Ã¶r. Twilio stub)
- Loglama: server & audit logs (Prisma middlewares + simple logger)
- i18n hazÄ±r altyapÄ± (tr varsayÄ±lan, en kolay eklenebilir)

## GÃ–RSEL VE MARKA
- Marka adÄ±: Ä°nsan Fizik Tedavi ve Rehabilitasyon Merkezi
- Renkler: aÃ§Ä±k mavi #3cb3d9, beyaz #ffffff, koyu lacivert #0e2240
- YazÄ± tipi: Poppins veya Open Sans (Google Fonts)
- GÃ¼ven veren, sade saÄŸlÄ±k arayÃ¼zÃ¼; eriÅŸilebilirlik (WCAG AA)

## ROLLER VE YETKÄ°LER
- ADMIN: her ÅŸeye tam yetki
- STAFF (sekreter): randevu, hasta, Ã¶deme/paket yÃ¶netimi; site iÃ§eriklerinde sÄ±nÄ±rlÄ±
- PHYSIO (fizyoterapist): kendi hastalarÄ±, seans notlarÄ±, egzersiz atamalarÄ±
- PATIENT (hasta): kendi profil, randevu, paket, egzersiz, mesaj/geri bildirim

## VERÄ° MODELÄ° (Prisma)
- User(id, role, name, email, phone, password_hash?, otp_secret?, isVerified, createdAt, updatedAt)
- Patient(id, userId?, fullName, birthDate?, gender?, phone, email?, address?, notes?, createdAt, updatedAt)
- Therapist(id, userId, title, expertise[], bio?, workHoursJSON, createdAt, updatedAt)
- Appointment(id, patientId, therapistId, date, startTime, endTime, status["PENDING","CONFIRMED","COMPLETED","CANCELLED","NO_SHOW"], channel["Clinic","Online"], createdAt, updatedAt)
- TreatmentPlan(id, patientId, therapistId, name, totalSessions, completedSessions, description?, createdAt, updatedAt)
- SessionNote(id, appointmentId, therapistId, painScale?, romJSON?, noteText, attachments[], createdAt)
- Package(id, name, sessionCount, price, description?, isActive, createdAt, updatedAt)
- Purchase(id, patientId, packageId, status["PENDING","PAID","REFUND"], paymentRef?, invoiceNumber?, createdAt, updatedAt)
- Exercise(id, slug, title, videoUrl?, stepsMarkdown, tags[], createdAt, updatedAt)
- AssignedExercise(id, patientId, exerciseId, frequencyPerWeek, startDate, endDate?, progressJSON)
- Message(id, fromUserId, toUserId, body, readAt?, createdAt)
- Feedback(id, patientId, rating(1-5), comment?, createdAt)
- Page(id, slug, title, contentHTML, excerpt?, coverImage?, status["DRAFT","PUBLISHED","SCHEDULED"], scheduledAt?, seoTitle?, seoDescription?, ogImage?, createdAt, updatedAt, authorId)
- Media(id, url, alt?, mime, size, uploadedById, createdAt)
- SiteSetting(id, key, valueJSON)  // telefon, adres, whatsapp numarasÄ±, sosyal linkler vb.
- AuditLog(id, userId?, action, entity, entityId?, metaJSON, createdAt)

Gerekli indexâ€™leri ekle (Ã¶rn. Appointment Ã¼zerinde date/startTime, Page.slug unique).

## KÄ°MLÄ°K DOÄRULAMA ve DOÄRULAMA KODLARI
- E-posta ile oturum aÃ§: magic link veya 6 haneli OTP (5 dk geÃ§erli, rate limit)
- Telefon OTP (stub servis; arayÃ¼z hazÄ±r, provider .env ile kolay baÄŸlanÄ±r)
- Ä°ki adÄ±mlÄ± doÄŸrulama opsiyonu (e-posta + telefon)
- Anti-brute force: IP bazlÄ± throttle (Ã¶rn. 5/10dk)
- "isVerified" bayraÄŸÄ±: ilk giriÅŸte e-posta OTP doÄŸrulamasÄ± zorunlu
- Åifre opsiyonunu esnek bÄ±rak (hem OTP hem ÅŸifre destekle)

## ADMIN PANELÄ° ("/admin" altÄ±nda, protected)
### 1) Hasta YÃ¶netimi
- Liste + arama + filtre (isim/telefon)
- Detay kartÄ±: profil bilgileri, geÃ§miÅŸ randevular, planlar, Ã¶demeler, dosyalar
- Dosya yÃ¼kleme: epikriz/rapor/rÃ¶ntgen (Media tablosuna)
- Notlar (private) + zaman damgasÄ±
- CSV iÃ§e/dÄ±ÅŸa aktar (Hasta ve Randevu)

### 2) Randevu YÃ¶netimi
- Takvim: gÃ¼nlÃ¼k/haftalÄ±k gÃ¶rÃ¼nÃ¼m, sÃ¼rÃ¼kle-bÄ±rak yeniden saatleme
- Randevu oluÅŸtur/dÃ¼zenle/iptal; durum yÃ¶netimi
- Terapiste/kliniÄŸe gÃ¶re filtre
- Otomatik hatÄ±rlatÄ±cÄ±: 
  - E-posta + WhatsApp deep link (Ã¶rn: wa.me/90XXXXXXXXXX?text=â€œRandevunuz yarÄ±n 14:00â€)
  - HatÄ±rlatma zamanlarÄ±: 24s, 3s Ã¶nce (SiteSetting ile yÃ¶net)

### 3) Fizyoterapist YÃ¶netimi
- Profil, uzmanlÄ±k etiketleri, Ã§alÄ±ÅŸma saatleri
- â€œAtanan hastalarâ€ ve â€œGÃ¼nlÃ¼k Ã¶zetâ€
- Seans notlarÄ± hÄ±zlÄ± giriÅŸ

### 4) Paket/Ã–deme YÃ¶netimi
- Paket CRUD (seans sayÄ±sÄ±, fiyat, aÃ§Ä±klama, aktif/pasif)
- SatÄ±n alma listesi, durum deÄŸiÅŸimi (PENDING/PAID/REFUND)
- Fatura no Ã¼retimi (INV-YYYY-XXXX)
- PayTR entegrasyonu iÃ§in server route: /api/payments/paytr-init (mock) ve callback
- PDF makbuz/ fatura Ã§Ä±ktÄ±sÄ± (basit html-to-pdf)

### 5) Ä°Ã§erik / Site YÃ¶netimi (CMS)
- **Sayfa CRUD**: baÅŸlÄ±k, slug (unique), iÃ§erik (rich text/blocks), kapak gÃ¶rseli
- **Durumlar**: DRAFT / PUBLISHED / SCHEDULED (zamanlayarak yayÄ±nla)
- **SEO**: seoTitle, seoDescription, ogImage. Otomatik meta injection.
- **Silme**: yumuÅŸak sil (soft delete yerine status: DRAFT + â€œarchivedâ€ flag da eklenebilir)
- **Blog** (Page ile aynÄ± model veya ayrÄ± â€œPostâ€ modeli opsiyonu; ÅŸimdilik Page yeterli)
- **Medya KÃ¼tÃ¼phanesi**: upload/rename/alt text dÃ¼zenle
- **Site AyarlarÄ±**: telefon, WhatsApp numarasÄ±, adres, harita iframe, sosyal linkler, Ã§alÄ±ÅŸma saatleri, e-posta ayarlarÄ±, logo
- **Rol bazlÄ± yayÄ±n**: sadece ADMIN yayÄ±nlayabilsin (STAFF taslak kaydedebilir)
- **Onay akÄ±ÅŸÄ± (opsiyonel)**: taslaktan â€œOnaya gÃ¶nderâ€, admin â€œYayÄ±nlaâ€

### 6) Raporlama & Loglar
- GÃ¼nlÃ¼k/haftalÄ±k randevu sayÄ±sÄ±, doluluk
- En Ã§ok uygulanan tedavi
- Paket satÄ±ÅŸlarÄ± ve ciro
- AuditLog listesi: kim neyi ne zaman yaptÄ±

## HASTA PANELÄ° ("/panel", protected: PATIENT)
- Profil: bilgiler, iletiÅŸim tercihi (mail/sms/whatsapp)
- Tedavi planÄ±: toplam/kalan seanslar
- Randevu: uygun saatleri gÃ¶r, oluÅŸtur/ertele/iptal (iptal politikasÄ± metni gÃ¶ster)
- SatÄ±n alÄ±nan paketler + Ã¶deme geÃ§miÅŸi; â€œSeans planlaâ€ kÄ±sayolu
- Egzersizler: fizyoterapistin atadÄ±ÄŸÄ± videolar + gÃ¼nlÃ¼k tamamla butonu + ilerleme yÃ¼zdesi
- Mesaj kutusu: fizyoterapist ile gÃ¼venli mesajlaÅŸma
- Geri bildirim: 1-5 puan + yorum (tamamlanan seans sonrasÄ±nda tetiklenir)

## GENEL KULLANICI ARAYÃœZÃœ (Public)
- Ana Sayfa (hero + CTA: â€œğŸ“ Hemen Araâ€, â€œğŸ’¬ WhatsAppâ€), 3-4 hizmet kartÄ±, hasta yorumlarÄ±, konum/harita
- HakkÄ±mÄ±zda (misyon/vizyon/ekip)
- Hizmetler (Fizik Tedavi, Manuel Terapi, Ortopedik Rehabilitasyon, Skolyoz, Bel/Boyun FÄ±tÄ±ÄŸÄ±, NÃ¶rolojik Rehabilitasyon; her biri 150-200 kelime aÃ§Ä±klamalÄ±, WhatsApp CTA)
- Uzman Kadro (terapist kartlarÄ±)
- Blog (Page Ã¼zerinden filtre â€œcategory:blogâ€ ile gÃ¶ster)
- Ä°letiÅŸim (telefon, WhatsApp, adres, Google Maps iframe, form)
- Sabit WhatsApp butonu (saÄŸ altta)
- SEO: Title/H1 hiyerarÅŸisi, schema.org HealthcareOrganization + Article

## API YÃœZEYÄ° (Ã¶rnekler)
- POST /api/auth/otp/request {email|phone} â†’ 200 (rate limit)
- POST /api/auth/otp/verify {email|phone, code} â†’ JWT session
- GET /api/patients?search=
- POST /api/patients  (ADMIN/STAFF)
- GET /api/appointments?therapistId=&date=
- POST /api/appointments (rol bazlÄ±)
- PATCH /api/appointments/:id/status
- POST /api/treatment-plans
- POST /api/session-notes
- POST /api/packages
- POST /api/purchases (init PayTR) â†’ payUrl veya iframe token
- POST /api/payments/paytr-callback  (signature verify, status update)
- CMS:
  - GET /api/pages?status=&q=
  - POST /api/pages  (slug unique; status DRAFT)
  - PATCH /api/pages/:id (publish/schedule)
  - DELETE /api/pages/:id  (soft delete veya archive)
  - POST /api/media (upload)
  - GET /api/settings / POST /api/settings

TÃ¼m korumalÄ± endpointâ€™lerde rol kontrolÃ¼ ve audit log tetikleyicisi kullan.

## GÃœVENLÄ°K & PERFORMANS
- Rate limit: auth ve public form endpointâ€™leri (IP baÅŸÄ±na)
- CSRF korumasÄ± (NextAuth + verifiable requests)
- Input validation: zod/yup
- Dosya yÃ¼klemede mime/size kontrolÃ¼; zararlÄ± iÃ§erik filtreleri
- .env Ã¶rneÄŸi: DATABASE_URL, NEXTAUTH_SECRET, SMTP_HOST/USER/PASS, PAYTR_MERCHANT_ID/KEY/SALT, SMS_PROVIDER_KEY, BASE_URL
- ISR/SSG + dinamik sayfalar iÃ§in cache headers; gÃ¶rsel optimizasyon

## GÃ–REVLER & HATIRLATICILAR
- Cron/route handler (edge-friendly) ile gÃ¼nlÃ¼k iÅŸ:
  - YarÄ±n randevusu olanlara e-posta + WhatsApp hatÄ±rlatma linki
  - SCHEDULED sayfalarÄ± zamanÄ± gelince PUBLISHED yap
- Failed job logla; retry politikasÄ±

## Ã–N YÃœZ BÄ°LEÅENLERÄ°
- Admin Layout: sidebar (Randevular, Hastalar, Terapistler, Paketler, Ä°Ã§erik, Medya, Ayarlar, Raporlar)
- Takvim: drag&drop (Ã¶rn. react-big-calendar muadili) â€“ uygun kÃ¼tÃ¼phane
- Rich Text Editor: tiptap/plate (temiz HTML Ã¼ret)
- Tablo/Filtre/Arama: hÄ±zlÄ± ve eriÅŸilebilir
- Toast/Banner uyarÄ±lar (baÅŸarÄ±lÄ±/baÅŸarÄ±sÄ±z iÅŸlemler)
- Formlar: aÃ§Ä±klamalÄ± placeholder, zorunlu alan iÅŸaretleri

## DEMO VERÄ° & TOHUMLAMA
- 2 terapist, 6 Ã¶rnek hasta, 8 Ã¶rnek sayfa (Ana sayfa, HakkÄ±mÄ±zda, 5 hizmet, Blog ana)
- 4 Ã¶rnek blog yazÄ±sÄ± (SEO uyumlu baÅŸlÄ±k/aÃ§Ä±klama)
- 3 paket (5/10/20 seans)
- 6 egzersiz (video veya placeholder link)

## TESLÄ°MAT
- Ã‡alÄ±ÅŸÄ±r Next.js projesi, `npm run dev` ile ayaklanÄ±r
- README: kurulum, .env Ã¶rneÄŸi, migrate, seed, PayTR test akÄ±ÅŸÄ±
- Kod temizliÄŸi: ESLint + Prettier
- AÃ§Ä±k ve yorumlu dosya yapÄ±sÄ±
- TÃ¼m kritik akÄ±ÅŸlar iÃ§in Ã¶rnek test (basic)

UygulamayÄ± kur, minimum uÃ§tan uca demo akÄ±ÅŸlarÄ±nÄ± Ã§alÄ±ÅŸÄ±r teslim et:
- Admin giriÅŸ â†’ sayfa oluÅŸtur (DRAFTâ†’PUBLISH) â†’ ana sitede gÃ¶rÃ¼nÃ¼r
- Hasta oluÅŸtur â†’ randevu ata â†’ hatÄ±rlatma jobâ€™u Ã§alÄ±ÅŸtÄ±r
- Paket oluÅŸtur â†’ satÄ±n alma baÅŸlat (mock PayTR) â†’ PAID â†’ seans planla
- Fizyoterapist â†’ seans notu gir â†’ hasta panelinde gÃ¶rÃ¼ntÃ¼lensin
